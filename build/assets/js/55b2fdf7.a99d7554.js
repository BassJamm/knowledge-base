"use strict";(self.webpackChunkknowledge_base=self.webpackChunkknowledge_base||[]).push([[5014],{2712:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var o=n(4848),t=n(8453);const r={title:"Backing up Resources in Azure",description:"Pointers for setting up Azure Backup.",slug:"Backing-up-resources-with-AzBackup",date:"2023-10-28T13:00",authors:[{name:"Will",title:"Creator of the IT KB.",url:"https://github.com/BassJamm?tab=repositories"}],tags:["hello","docusaurus-v2"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},s=void 0,c={permalink:"/blog/Backing-up-resources-with-AzBackup",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-10-28-Azure-Backup/Backing-up-VMs.md",source:"@site/blog/2023-10-28-Azure-Backup/Backing-up-VMs.md",title:"Backing up Resources in Azure",description:"Pointers for setting up Azure Backup.",date:"2023-10-28T13:00:00.000Z",tags:[{label:"hello",permalink:"/blog/tags/hello"},{label:"docusaurus-v2",permalink:"/blog/tags/docusaurus-v-2"}],readingTime:1.6,hasTruncateMarker:!0,authors:[{name:"Will",title:"Creator of the IT KB.",url:"https://github.com/BassJamm?tab=repositories"}],frontMatter:{title:"Backing up Resources in Azure",description:"Pointers for setting up Azure Backup.",slug:"Backing-up-resources-with-AzBackup",date:"2023-10-28T13:00",authors:[{name:"Will",title:"Creator of the IT KB.",url:"https://github.com/BassJamm?tab=repositories"}],tags:["hello","docusaurus-v2"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},unlisted:!1,lastUpdatedAt:1716029867e3,nextItem:{title:"Automate Scripts in Azure",permalink:"/blog/Automate-scripts-in-Azure"}},l={authorsImageUrls:[void 0]},a=[{value:"Before you dive in",id:"before-you-dive-in",level:2},{value:"The Run down",id:"the-run-down",level:2},{value:"Creating the Resources",id:"creating-the-resources",level:3},{value:"Configure Backup Policy",id:"configure-backup-policy",level:3},{value:"Configure Alerting",id:"configure-alerting",level:3},{value:"Configure Diagnostic log collection",id:"configure-diagnostic-log-collection",level:3}];function u(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.p,{children:"An outline of setting up Azure Backup and the decisions around doing so that I learn along the way."}),"\n",(0,o.jsx)(i.p,{children:"Azure Backup is a Microsoft Azure service that provides reliable and cost-effective data protection for your critical workloads. It enables you to securely back up and recover data from on-premises systems and Azure virtual machines, offering peace of mind for safeguarding your business-critical information."}),"\n",(0,o.jsx)(i.admonition,{title:"It might not be the best way!",type:"note",children:(0,o.jsx)(i.p,{children:"This document is for setting backup policeis for Virutal Machines only. If you need to backup other resources, go to section 1.2, step 4 and select a differnet resource."})}),"\n",(0,o.jsx)(i.h2,{id:"before-you-dive-in",children:"Before you dive in"}),"\n",(0,o.jsx)(i.p,{children:"Some decisions to consider before clicking about and winging it:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Policy Naming Conventions."}),"\n",(0,o.jsx)(i.li,{children:"How are you going to group your resources? (Don't care or different policies per resource type?)"}),"\n",(0,o.jsx)(i.li,{children:"Backup Schedules."}),"\n",(0,o.jsx)(i.li,{children:"Alerting."}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"You'll need to setup the following:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"A resource Group."}),"\n",(0,o.jsx)(i.li,{children:"Service Recovery Services Vault."}),"\n",(0,o.jsx)(i.li,{children:"Log Analytics Workspace."}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"the-run-down",children:"The Run down"}),"\n",(0,o.jsx)(i.admonition,{type:"info",children:(0,o.jsx)(i.p,{children:"Use whatever naming conention fits in with what\u2019s being used already, I am just suggesting something here."})}),"\n",(0,o.jsx)(i.p,{children:"Below sections outline my steps for setting up Azure Backup."}),"\n",(0,o.jsx)(i.h3,{id:"creating-the-resources",children:"Creating the Resources"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["Create the resource group, for example, ",(0,o.jsx)(i.code,{children:"rg-customername-region-prod/dev-backups-01"}),"."]}),"\n",(0,o.jsxs)(i.li,{children:["Create a recovery services vault to store the backups (GRS is the preferred option, LRS for lowest cost), for example, ",(0,o.jsx)(i.code,{children:"rsv-customername-region-prod/dev-backup-01"}),"."]}),"\n",(0,o.jsxs)(i.li,{children:["Create a log analytics workspace or reuse another one, for example, ",(0,o.jsx)(i.code,{children:"la-customername-region-prod/dev-backup-01"}),"."]}),"\n"]}),"\n",(0,o.jsx)(i.h3,{id:"configure-backup-policy",children:"Configure Backup Policy"}),"\n",(0,o.jsx)(i.p,{children:"Configure the backup policy in-line with whatever standard is being used already, my suggestions are below."}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsx)(i.li,{children:"In the Azure portal, select a Recovery Services vault to back up the VM."}),"\n",(0,o.jsx)(i.li,{children:"Under Backup, select Backup Policies."}),"\n",(0,o.jsx)(i.li,{children:"Click +Add."}),"\n",(0,o.jsx)(i.li,{children:"On Select policy type, select Azure Virtual Machine."}),"\n",(0,o.jsx)(i.li,{children:"On Create policy, perform the following actions:"}),"\n",(0,o.jsx)(i.li,{children:"Policy sub type: Standard"}),"\n",(0,o.jsxs)(i.li,{children:["Suggested Name format: ",(0,o.jsx)(i.code,{children:"Bkup-policy-time of day-policy type"})," (example name: bkup-policy-nightly-std)."]}),"\n"]}),"\n",(0,o.jsx)(i.h3,{id:"configure-alerting",children:"Configure Alerting"}),"\n",(0,o.jsx)(i.admonition,{type:"tip",children:(0,o.jsx)(i.p,{children:"Note that this method is using the old backup alerting method, this is being replaced by Azure Monitor."})}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/azure/backup/backup-azure-monitoring-built-in-monitor?tabs=recovery-services-vaults#turning-on-azure-monitor-alerts-for-job-failure-scenarios",children:"Microsoft Link for more information"})}),"\n",(0,o.jsx)(i.p,{children:"Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above."}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsx)(i.li,{children:"From the Recovery services vault just setup."}),"\n",(0,o.jsx)(i.li,{children:"Click on Backup Alerts, under the Monitoring section."}),"\n",(0,o.jsx)(i.li,{children:"Click Configure Notifications."}),"\n",(0,o.jsx)(i.li,{children:"Enable Notifications: Yes"}),"\n",(0,o.jsxs)(i.li,{children:["Recipients(Email): '",(0,o.jsx)(i.a,{href:"mailto:monitoring@DomainName.com",children:"monitoring@DomainName.com"}),"'"]}),"\n",(0,o.jsx)(i.li,{children:"Notify: Hourly digest"}),"\n",(0,o.jsx)(i.li,{children:"Severity: Critical & Warning"}),"\n"]}),"\n",(0,o.jsx)(i.h3,{id:"configure-diagnostic-log-collection",children:"Configure Diagnostic log collection"}),"\n",(0,o.jsx)(i.p,{children:"Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above."}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsx)(i.li,{children:"Navigate to Diagnostic settings under Monitoring."}),"\n",(0,o.jsx)(i.li,{children:"Click Add Diagnostic Settings."}),"\n",(0,o.jsx)(i.li,{children:"Name your diagnostic setting, something informational, for example, \u201cAzBkup-Diagnostics\u201d, suggestion, Backup Report Data."}),"\n",(0,o.jsx)(i.li,{children:"Select Send to Log Analytics Workspace."}),"\n",(0,o.jsx)(i.li,{children:"Add a workspace and don\u2019t touch any other settings."}),"\n",(0,o.jsx)(i.li,{children:"Hit Save."}),"\n"]}),"\n",(0,o.jsx)(i.admonition,{type:"tip",children:(0,o.jsx)(i.p,{children:"Make sure to run the initial backup job from the Azure Backup Dashboard."})})]})}function d(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>c});var o=n(6540);const t={},r=o.createContext(t);function s(e){const i=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:i},e.children)}}}]);