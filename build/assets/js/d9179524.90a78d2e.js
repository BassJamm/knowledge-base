"use strict";(self.webpackChunkknowledge_base=self.webpackChunkknowledge_base||[]).push([[5714],{7413:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var o=t(4848),i=t(8453);const a={draft:!1,id:"destroy-mcafee",title:"Uninstall McAfee",sidebar_label:"Uninstall McAfee",sidebar_position:3,pagination_label:"Uninstall McAfee",description:"Remove McAfee using Intune and PowerShell.",toc_max_heading_level:4,custom_edit_url:null,tags:["Intune","Apps","Uninstall"]},s=void 0,l={id:"Microsoft Intune/App Management/destroy-mcafee",title:"Uninstall McAfee",description:"Remove McAfee using Intune and PowerShell.",source:"@site/docs/Microsoft Intune/App Management/Destroy-McAfee.md",sourceDirName:"Microsoft Intune/App Management",slug:"/Microsoft Intune/App Management/destroy-mcafee",permalink:"/docs/Microsoft Intune/App Management/destroy-mcafee",draft:!1,unlisted:!1,editUrl:null,tags:[{label:"Intune",permalink:"/docs/tags/intune"},{label:"Apps",permalink:"/docs/tags/apps"},{label:"Uninstall",permalink:"/docs/tags/uninstall"}],version:"current",sidebarPosition:3,frontMatter:{draft:!1,id:"destroy-mcafee",title:"Uninstall McAfee",sidebar_label:"Uninstall McAfee",sidebar_position:3,pagination_label:"Uninstall McAfee",description:"Remove McAfee using Intune and PowerShell.",toc_max_heading_level:4,custom_edit_url:null,tags:["Intune","Apps","Uninstall"]},sidebar:"tutorialSidebar",previous:{title:"Useful CA Policies",permalink:"/docs/Microsoft Entra/Conditional Access/Useful Conditional Access Policies"},next:{title:"Harmful files promtp on Entra joined device",permalink:"/docs/Windows Desktop OS/App Management/Harmful_Files_prompt"}},r={},c=[{value:"Creating the Uninstall package",id:"creating-the-uninstall-package",level:2},{value:"Create an IntuneWin package with the Microsoft Win32 Content Prep Tool",id:"create-an-intunewin-package-with-the-microsoft-win32-content-prep-tool",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://www.tbone.se/2021/03/05/mcafee-cleanup-with-intune/",children:"Blog post I stole the steps from"})})}),"\n",(0,o.jsx)(n.h2,{id:"creating-the-uninstall-package",children:"Creating the Uninstall package"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Download ",(0,o.jsx)(n.a,{href:"https://download.mcafee.com/molbin/iss-loc/SupportTools/MCPR/MCPR.exe",children:"McAfee Consumer Product Removal Tool"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Start the downloaded ",(0,o.jsx)(n.strong,{children:"MCPR.exe"})," and then ",(0,o.jsx)(n.strong,{children:"Hold it open\u2026"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["While this dialog is open, navigate to the unpacked source files in: ",(0,o.jsx)(n.code,{children:"%localappdata%\\temp"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Copy the folder MCPR to a suitable place for packageing, for example ",(0,o.jsx)(n.code,{children:"c:\\temp\\McAfeeRemover"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Close the"})," still open ",(0,o.jsx)(n.strong,{children:"McAfee Software"})," Removal tool by clicking cancel."]}),"\n",(0,o.jsxs)(n.li,{children:["Create a Powershell script in the folder above, for example ",(0,o.jsx)(n.code,{children:"c:\\temp\\McAfeeRemover\\McAfeeRemover.ps1"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"I had some issues using the most up to date removal tool, if the script keeps failing for no reason, I'd suggest searching the internet for an older version of the tool."})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Powershell",children:'<#  Pre-Reqs\n\n    Follow guidance: https://www.tbone.se/2021/03/05/mcafee-cleanup-with-intune/\n    \n#>\n\n# Run the cleanup tool\n# Remove the older application installation versions of McAfee\n$program= ".\\McCleanup.exe"\n$programArg= "-p StopServices,MFSY,PEF,MXD,CSP,Sustainability,MOCP,MFP,APPSTATS,Auth,EMproxy,FWdiver,HW,MAS,MAT,MBK,MCPR,McProxy,McSvcHost,VUL,MHN,MNA,MOBK,MPFP,MPFPCU,MPS,SHRED,MPSCU,MQC,MQCCU,MSAD,MSHR,MSK,MSKCU,MWL,NMC,RedirSvc,VS,REMEDIATION,MSC,YAP,TRUEKEY,LAM,PCB,Symlink,SafeConnect,MGS,WMIRemover,RESIDUE -v -s"\n$process = Start-Process $program -ArgumentList $ProgramArg -passthru -Wait -NoNewWindow\n\n# Remove the Microsoft Store apps from McAfee\n$RemoveApp = \'Mcafee\'\nGet-AppxPackage -AllUsers | Where-Object Name -Match $RemoveApp | Remove-AppxPackage\nGet-AppxPackage | Where-Object Name -Match $RemoveApp | Remove-AppxPackage\nGet-AppxProvisionedPackage -Online | Where-Object PackageName -Match $RemoveApp | Remove-AppxProvisionedPackage -Online\n'})}),"\n",(0,o.jsx)(n.h2,{id:"create-an-intunewin-package-with-the-microsoft-win32-content-prep-tool",children:"Create an IntuneWin package with the Microsoft Win32 Content Prep Tool"}),"\n",(0,o.jsxs)(n.p,{children:["Catalog files are used to enable Win32 apps in Windows 10 S mode -- they are specific to Application Control which is the mechanism that S Mode uses to enforce and control applications. Lots of details on this at ",(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/mem/intune/apps/apps-win32-s-mode",children:"https://docs.microsoft.com/en-us/mem/intune/apps/apps-win32-s-mode"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var o=t(6540);const i={},a=o.createContext(i);function s(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);